#!/bin/bash

# –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è pull —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

set -e

echo "üîÑ Git pull —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π..."

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ stash
echo "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ stash..."
git stash push -m "Local changes before pull $(date +%Y-%m-%d_%H:%M:%S)"

# –î–µ–ª–∞–µ–º pull
echo ""
echo "üì• Pull –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
git pull

# –ü—ã—Ç–∞–µ–º—Å—è –≤–µ—Ä–Ω—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
echo ""
echo "üíæ –ü–æ–ø—ã—Ç–∫–∞ –≤–µ—Ä–Ω—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ stash..."
if git stash pop; then
    echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã"
else
    echo "‚ö†Ô∏è  –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
    echo "–†–∞–∑—Ä–µ—à–∏—Ç–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤—Ä—É—á–Ω—É—é –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: git stash drop"
fi

echo ""
echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"

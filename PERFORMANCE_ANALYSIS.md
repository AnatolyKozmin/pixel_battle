# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã Pixel Battle

## üìä –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **Backend**: FastAPI (async) + Uvicorn
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL —Å pgbouncer (connection pooling)
- **–ö–µ—à**: Redis (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ + Pub/Sub)
- **Frontend**: Vue.js (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π, —á–µ—Ä–µ–∑ Nginx)
- **WebSocket**: Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Redis Pub/Sub

---

## üéØ –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (1 –∏–Ω—Å—Ç–∞–Ω—Å):

#### –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:
- **~500-1000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
- **~50-100 —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É** (RPS)
- **~1000 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π**

#### –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:
- **~200-500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
- **~20-50 —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É** (RPS)
- **~500 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π**

#### –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:
- **~100-200 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
- **~10-20 —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É** (RPS)
- **~200 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π**

---

## üîç –£–∑–∫–∏–µ –º–µ—Å—Ç–∞ (Bottlenecks)

### 1. **PostgreSQL** (–∫—Ä–∏—Ç–∏—á–Ω–æ)
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –ø–∏–∫—Å–µ–ª—è = 2-3 –∑–∞–ø—Ä–æ—Å–∞ –∫ –ë–î:
  - `SELECT` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–∏–∫—Å–µ–ª—è
  - `UPDATE` –∏–ª–∏ `INSERT` –ø–∏–∫—Å–µ–ª—è
  - `UPDATE` —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏ 50 RPS = **150-200 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ –∫ –ë–î**

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ Pgbouncer —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (connection pooling)
- ‚ö†Ô∏è –ù—É–∂–Ω—ã –∏–Ω–¥–µ–∫—Å—ã: `(x, y)` –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ `pixels`
- ‚ö†Ô∏è –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å batch updates –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚ö†Ô∏è –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ: read replicas –¥–ª—è —á—Ç–µ–Ω–∏—è —Ö–æ–ª—Å—Ç–∞

### 2. **Redis Pub/Sub** (—Å—Ä–µ–¥–Ω–µ)
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ = –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Redis
- WebSocket broadcast –≤—Å–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º
- –ü—Ä–∏ 1000 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π = 1000 –æ—Ç–ø—Ä–∞–≤–æ–∫ –Ω–∞ –∫–∞–∂–¥–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ Redis Pub/Sub —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è broadcast
- ‚ö†Ô∏è –ü—Ä–∏ >1000 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π: —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å Redis Streams
- ‚ö†Ô∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (–º–∏–Ω–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö)

### 3. **WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** (—Å—Ä–µ–¥–Ω–µ)
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ = –ø–∞–º—è—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- FastAPI WebSocket = ~1-2 KB –Ω–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- 1000 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π = ~1-2 MB –ø–∞–º—è—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (FastAPI async)
- ‚ö†Ô∏è –ü—Ä–∏ >5000 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π: —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π WebSocket —Å–µ—Ä–≤–µ—Ä
- ‚ö†Ô∏è Heartbeat/ping-pong –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –º–µ—Ä—Ç–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### 4. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö–æ–ª—Å—Ç–∞** (—Ö–æ—Ä–æ—à–æ)
**–¢–µ–∫—É—â–µ–µ:**
- ‚úÖ Redis –∫–µ—à –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ö–æ–ª—Å—Ç–∞ (TTL 5 –º–∏–Ω—É—Ç)
- ‚úÖ –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚ö†Ô∏è –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —á–∞–Ω–∫–∞–º (–¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏)
- ‚ö†Ô∏è CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ (frontend)

### 5. **Webhook –≤—ã–∑–æ–≤—ã** (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∫ n8n
- –ú–æ–≥—É—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –æ—Ç–≤–µ—Ç, –µ—Å–ª–∏ n8n –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–∂–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ (–Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç)
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å timeout –∏ retry logic
- ‚ö†Ô∏è –û—á–µ—Ä–µ–¥—å –¥–ª—è webhook'–æ–≤ (Celery/RQ)

---

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: 1000-2000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```
- 2-3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ backend
- 1 PostgreSQL (—Å pgbouncer)
- 1 Redis
- Load balancer (Nginx)
```
**–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ~100-200 RPS —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π
- ~2000 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: 2000-5000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```
- 5-10 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ backend
- 1 PostgreSQL (master) + 1 read replica
- 1 Redis (–∏–ª–∏ Redis Cluster)
- Load balancer (Nginx/HAProxy)
```
**–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ~200-500 RPS —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π
- ~5000 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: 5000-10000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```
- 10-20 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ backend
- PostgreSQL cluster (master + 2 replicas)
- Redis Cluster
- Load balancer (HAProxy/Nginx)
- –û—Ç–¥–µ–ª—å–Ω—ã–π WebSocket —Å–µ—Ä–≤–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```
**–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ~500-1000 RPS —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π
- ~10000 WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–±—ã—Å—Ç—Ä—ã–µ):

1. **–ò–Ω–¥–µ–∫—Å—ã –ë–î:**
```sql
CREATE INDEX idx_pixel_xy ON pixels(x, y);
CREATE INDEX idx_pixel_user_id ON pixels(user_id);
CREATE INDEX idx_user_last_pixel ON users(last_pixel_at);
```

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ON CONFLICT` –¥–ª—è upsert (PostgreSQL)
- Batch updates –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Connection pooling (—É–∂–µ –µ—Å—Ç—å pgbouncer)

3. **Redis –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –£–≤–µ–ª–∏—á–∏—Ç—å TTL –∫–µ—à–∞ —Ö–æ–ª—Å—Ç–∞ –¥–æ 10-15 –º–∏–Ω—É—Ç
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis pipelining –¥–ª—è batch –æ–ø–µ—Ä–∞—Ü–∏–π

4. **Rate limiting:**
- –í–∫–ª—é—á–∏—Ç—å rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ API (—Å–µ–π—á–∞—Å –æ—Ç–∫–ª—é—á–µ–Ω)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 10-20 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —á–∞–Ω–∫–∞–º:**
   - –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å –Ω–µ –≤–µ—Å—å —Ö–æ–ª—Å—Ç, –∞ —á–∞–Ω–∫–∏ 100x100
   - –£–º–µ–Ω—å—à–∏—Ç —Ä–∞–∑–º–µ—Ä –∫–µ—à–∞ –∏ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

2. **Read replicas:**
   - –ß—Ç–µ–Ω–∏–µ —Ö–æ–ª—Å—Ç–∞ —Å replica
   - –ó–∞–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –Ω–∞ master

3. **WebSocket –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
   - –°–∂–∞—Ç–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (gzip)
   - Batching –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–Ω–µ –∫–∞–∂–¥–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ)

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - Prometheus + Grafana
   - –ú–µ—Ç—Ä–∏–∫–∏: RPS, latency, WebSocket connections, DB connections

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã:**
   - –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è WebSocket
   - –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è webhook'–æ–≤

2. **–û—á–µ—Ä–µ–¥–∏:**
   - Celery/RQ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
   - –û—á–µ—Ä–µ–¥—å –¥–ª—è webhook'–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

3. **CDN:**
   - –°—Ç–∞—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ CDN
   - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ API –æ—Ç–≤–µ—Ç–æ–≤ (–¥–ª—è —á—Ç–µ–Ω–∏—è)

---

## üíæ –†–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (1 –∏–Ω—Å—Ç–∞–Ω—Å):
- **CPU**: 2 cores
- **RAM**: 2-4 GB
- **–î–∏—Å–∫**: 20 GB SSD
- **–°–µ—Ç—å**: 100 Mbps

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ (1 –∏–Ω—Å—Ç–∞–Ω—Å):
- **CPU**: 4 cores
- **RAM**: 8 GB
- **–î–∏—Å–∫**: 50 GB SSD
- **–°–µ—Ç—å**: 1 Gbps

### –î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (per –∏–Ω—Å—Ç–∞–Ω—Å):
- **CPU**: 2-4 cores
- **RAM**: 4-8 GB
- **–î–∏—Å–∫**: 50 GB SSD
- **–°–µ—Ç—å**: 1 Gbps

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ:
- **RPS —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π** (—Ü–µ–ª–µ–≤–æ–π: <100 RPS –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å)
- **Latency API** (—Ü–µ–ª–µ–≤–æ–π: <100ms –¥–ª—è 95 percentile)
- **DB connections** (—Ü–µ–ª–µ–≤–æ–π: <80% –æ—Ç max_connections)
- **WebSocket connections** (—Ü–µ–ª–µ–≤–æ–π: <1000 –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å)

### –í–∞–∂–Ω—ã–µ:
- **Redis memory usage** (—Ü–µ–ª–µ–≤–æ–π: <80% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏)
- **CPU usage** (—Ü–µ–ª–µ–≤–æ–π: <70% —Å—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞)
- **Memory usage** (—Ü–µ–ª–µ–≤–æ–π: <80% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏)
- **Network bandwidth** (—Ü–µ–ª–µ–≤–æ–π: <80% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π)

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

### –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ (1 –∏–Ω—Å—Ç–∞–Ω—Å, –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π):
**~200-500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
**~20-50 —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É**

### –° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏ (1 –∏–Ω—Å—Ç–∞–Ω—Å):
**~500-1000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
**~50-100 —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É**

### –° –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º (5 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤):
**~2000-5000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
**~200-500 —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É**

### –° –ø–æ–ª–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π (10+ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤):
**~5000-10000+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (–∞–∫—Ç–∏–≤–Ω—ã—Ö)
**~500-1000+ —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É**

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ö—É–ª–¥–∞—É–Ω –æ—Ç–∫–ª—é—á–µ–Ω** - —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–ø–∞–º—É. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å rate limiting.

2. **Webhook –≤—ã–∑–æ–≤—ã** - –µ—Å–ª–∏ n8n –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –æ—Ç–≤–µ—Ç. –î–æ–±–∞–≤–∏—Ç—å timeout.

3. **–ò–Ω–¥–µ–∫—Å—ã –ë–î** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤.

4. **Connection pooling** - pgbouncer —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –±–µ–∑ –º–µ—Ç—Ä–∏–∫ —Å–ª–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.

---

## üîß –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
SELECT indexname, indexdef FROM pg_indexes WHERE tablename = 'pixels';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
SELECT pg_size_pretty(pg_total_relation_size('pixels'));

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏–∫—Å–µ–ª–µ–π
SELECT COUNT(*) FROM pixels;
```

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis –ø–∞–º—è—Ç—å
redis-cli INFO memory

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
redis-cli INFO clients
```

---

## üìù –í—ã–≤–æ–¥—ã

**–°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –≤—ã–¥–µ—Ä–∂–∞—Ç—å:**
- **–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π**: ~200-500 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–° –±–∞–∑–æ–≤—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏**: ~500-1000 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–° –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º**: ~2000-10000+ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. –ò–Ω–¥–µ–∫—Å—ã –ë–î
2. –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ backend
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
4. Rate limiting
